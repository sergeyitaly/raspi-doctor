<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Pi AI Health Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <i class="fas fa-microchip logo-icon"></i>
          <div>
            <h1>Pi AI Doctor</h1>
            <div class="muted">Autonomous Health Monitoring Â· Local LLM</div>
          </div>
        </div>
        <div class="status-cards">
          <div class="status-card ok">
            <div class="status-indicator ok"></div>
            <div>
              <div class="status-text">System</div>
              <div class="status-value" id="header-status">OK</div>
            </div>
          </div>
          <div class="status-card ok">
            <div class="status-indicator ok"></div>
            <div>
              <div class="status-text">CPU</div>
              <div class="status-value" id="header-cpu">--Â°C</div>
            </div>
          </div>
          <div class="status-card ok">
            <div class="status-indicator ok"></div>
            <div>
              <div class="status-text">Memory</div>
              <div class="status-value" id="header-memory">--%</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <div class="container">
    <!-- Real-time Metrics -->
    <div class="metrics-grid">
      <div class="metric-card">
        <div class="metric-header">
          <div class="metric-title">CPU Temperature</div>
          <i class="fas fa-temperature-high metric-icon"></i>
        </div>
        <div class="metric-value" id="metric-cpu">--Â°C</div>
        <div class="metric-trend trend-neutral" id="cpu-trend">
          <i class="fas fa-minus"></i>
          <span>Loading...</span>
        </div>
      </div>

      <div class="metric-card">
        <div class="metric-header">
          <div class="metric-title">Memory Usage</div>
          <i class="fas fa-memory metric-icon"></i>
        </div>
        <div class="metric-value" id="metric-memory">--%</div>
        <div class="metric-trend trend-neutral" id="memory-trend">
          <i class="fas fa-minus"></i>
          <span>Loading...</span>
        </div>
      </div>

      <div class="metric-card">
        <div class="metric-header">
          <div class="metric-title">Disk Usage</div>
          <i class="fas fa-hard-drive metric-icon"></i>
        </div>
        <div class="metric-value" id="metric-disk">--%</div>
        <div class="metric-trend trend-neutral" id="disk-trend">
          <i class="fas fa-minus"></i>
          <span>Loading...</span>
        </div>
      </div>

      <div class="metric-card">
        <div class="metric-header">
          <div class="metric-title">AI Doctor</div>
          <i class="fas fa-brain metric-icon"></i>
        </div>
        <div class="metric-value" id="ai-doctor-status">Active</div>
        <div class="metric-trend">
          <span class="tag tag-success" id="ollama-status">Ollama Ready</span>
        </div>
      </div>
    </div>

    <!-- Main Dashboard Grid -->
    <div class="dashboard-grid">
      <!-- System Health Card -->
      <div class="card">
        <div class="card-header">
          <h2><i class="fas fa-heart-pulse card-icon"></i> System Health</h2>
          <span class="tag tag-success" id="overall-health">Good</span>
        </div>
        <div class="card-content compact-content">
          <div class="grid-2">
            <div>
              <div class="stat-row">
                <span class="stat-label">Uptime:</span>
                <span class="stat-value" id="uptime">--</span>
              </div>
              <div class="stat-row">
                <span class="stat-label">Load Avg:</span>
                <span class="stat-value" id="load-avg">--</span>
              </div>
              <div class="stat-row">
                <span class="stat-label">Processes:</span>
                <span class="stat-value" id="process-count">--</span>
              </div>
            </div>
            <div>
              <div class="stat-row">
                <span class="stat-label">CPU Cores:</span>
                <span class="stat-value" id="cpu-cores">--</span>
              </div>
              <div class="stat-row">
                <span class="stat-label">Memory:</span>
                <span class="stat-value" id="total-memory">--</span>
              </div>
              <div class="stat-row">
                <span class="stat-label">Disk:</span>
                <span class="stat-value" id="total-disk">--</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Database Metrics Card -->
      <div class="card">
        <div class="card-header">
          <h2><i class="fas fa-database card-icon"></i> Database Metrics</h2>
          <span class="tag tag-info" id="db-status">Active</span>
        </div>
        <div class="card-content compact-content">
          <div class="stat-row">
            <span class="stat-label">Patterns Learned:</span>
            <span class="stat-value" id="patterns-count">--</span>
          </div>
          <div class="stat-row">
            <span class="stat-label">Actions Taken:</span>
            <span class="stat-value" id="actions-count">--</span>
          </div>
          <div class="stat-row">
            <span class="stat-label">Metrics Stored:</span>
            <span class="stat-value" id="metrics-count">--</span>
          </div>
          <div class="stat-row">
            <span class="stat-label">Success Rate:</span>
            <span class="stat-value" id="success-rate">--%</span>
          </div>
        </div>
      </div>

      <!-- AI Doctor Live Actions -->
      <div class="card">
        <div class="card-header">
          <h2><i class="fas fa-robot card-icon"></i> AI Doctor Live</h2>
          <span class="tag tag-info" id="ai-status">Active</span>
        </div>
        <div class="card-content">
          <div id="ollama-actions">
            <div class="ollama-action">
              <div class="timestamp">Just now</div>
              <div class="ollama-thinking">ðŸ¤– Analyzing system health patterns...</div>
            </div>
          </div>
        </div>
        <div class="actions">
          <button id="ai-diagnose">
            <i class="fas fa-stethoscope"></i>
            Diagnose
          </button>
          <button id="refresh-ai" class="secondary">
            <i class="fas fa-sync-alt"></i>
          </button>
        </div>
      </div>

      <!-- Network Status Card -->
      <div class="card">
        <div class="card-header">
          <h2><i class="fas fa-network-wired card-icon"></i> Network</h2>
          <span class="tag tag-success">Stable</span>
        </div>
        <div class="card-content">
          <div class="preformatted" id="network">Loading network data...</div>
        </div>
      </div>

      <!-- Security Status Card -->
      <div class="card">
        <div class="card-header">
          <h2><i class="fas fa-shield-alt card-icon"></i> Security</h2>
          <span class="tag tag-success">Secure</span>
        </div>
        <div class="card-content">
          <div class="preformatted" id="security">Loading security data...</div>
        </div>
      </div>

      <!-- Hardware Monitoring Card -->
      <div class="card">
        <div class="card-header">
          <h2><i class="fas fa-gauge-high card-icon"></i> Live Metrics</h2>
          <span class="tag tag-success">Real-time</span>
        </div>
        <div class="card-content">
          <div class="chart-container">
            <canvas id="hardwareChart"></canvas>
          </div>
        </div>
      </div>

      <!-- AI Analysis Card -->
      <div class="card">
        <div class="card-header">
          <h2><i class="fas fa-brain card-icon"></i> AI Analysis</h2>
          <span class="tag tag-warning">Analysis</span>
        </div>
        <div class="card-content">
          <div class="summary" id="summary">Click "Analyze" to get AI insights about your system health and performance.</div>
        </div>
        <div class="actions">
          <button id="analyze">
            <i class="fas fa-brain"></i>
            Analyze
          </button>
        </div>
      </div>
    </div>

    <!-- System Logs (Collapsible) -->
    <div class="card">
      <div class="card-header collapsible" onclick="toggleLogs()">
        <h2><i class="fas fa-terminal card-icon"></i> System Logs</h2>
        <span class="tag tag-info">Click to expand</span>
      </div>
      <div class="collapsible-content" id="logs-content">
        <div class="card-content">
          <div class="preformatted" id="raw-logs">{{ latest }}</div>
        </div>
        <div class="actions">
          <button id="clear-logs" class="secondary">
            <i class="fas fa-trash"></i>
            Clear
          </button>
          <button id="refresh-logs" class="secondary">
            <i class="fas fa-sync-alt"></i>
            Refresh
          </button>
        </div>
      </div>
    </div>
  </div>
  <script src="{{ url_for('static', filename='main.js') }}"></script>
</body>
</html>